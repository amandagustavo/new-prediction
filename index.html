<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D·ª± ƒêo√°n Kh·∫£ NƒÉng Ngh·ªâ Vi·ªác C·ªßa Nh√¢n Vi√™n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        .prediction-result {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        .prediction-result.show {
            opacity: 1;
            transform: translateY(0);
        }
        .form-label {
            font-weight: 500;
        }
        .btn-predict {
            background-color: #007bff;
            color: white;
            padding: 10px 30px;
        }
        .model-card {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .model-card .alert {
            margin-bottom: 0;
            border-radius: 8px;
            padding: 20px;
        }
        .model-card h5 {
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }
        .model-card p {
            margin-bottom: 10px;
            font-size: 16px;
        }
        .model-card strong {
            font-weight: 600;
            color: #555;
        }
        .alert-success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .alert-danger {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .best-model {
            border: 2px solid #28a745;
        }
        /* Styles cho form feedback */
        .btn-check {
            display: none;
        }
        
        .btn-check + label {
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 10px;
            transition: all 0.3s;
            width: 100px;
        }
        
        .btn-check:checked + label {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .btn-check + label i {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        #feedback-form {
            background: linear-gradient(to right bottom, #ffffff, #f8f9fa);
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
        }
        
        textarea.form-control:focus {
            box-shadow: none;
            border-color: #007bff;
        }
        
        .feedback-success {
            animation: fadeInOut 3s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }
        .form-group {
            margin-bottom: 20px;
        }
        .rating {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        .rating label {
            cursor: pointer;
            padding: 10px 15px;
            border-radius: 10px;
            transition: all 0.3s ease;
            text-align: center;
            min-width: 100px;
        }
        .rating label:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .rating input[type="radio"] {
            display: none;
        }
        .rating input[type="radio"]:checked + div {
            color: #fff;
        }
        .rating label:has(input[type="radio"]:checked) {
            background-color: #0d6efd;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        #feedback-form {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-top: 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .feedback-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .feedback-header h5 {
            color: #333;
            font-weight: 600;
        }
        .feedback-input {
            margin-top: 20px;
        }
        .feedback-buttons {
            margin-top: 30px;
            text-align: center;
        }
        .alert {
            border-radius: 10px;
            padding: 15px 20px;
        }
        #server-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .status-connected {
            background-color: #28a745;
            color: white;
        }
        
        .status-disconnected {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
    <div id="server-status">ƒêang ki·ªÉm tra k·∫øt n·ªëi...</div>
    <div class="container">
        <h2 class="text-center mb-4">D·ª± ƒêo√°n Kh·∫£ NƒÉng Ngh·ªâ Vi·ªác C·ªßa Nh√¢n Vi√™n</h2>
        <form id="prediction-form">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="form-label">Tu·ªïi</label>
                    <input type="number" class="form-control" name="Age" min="18" max="100" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">Gi·ªõi T√≠nh</label>
                    <select class="form-select" name="Gender" required>
                        <option value="Male">Nam</option>
                        <option value="Female">N·ªØ</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">S·ªë NƒÉm L√†m Vi·ªác</label>
                    <input type="number" class="form-control" name="Years_at_Company" min="0" step="1" required>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="form-label">V·ªã Tr√≠ C√¥ng Vi·ªác</label>
                    <select class="form-select" name="Job_Role" required>
                        <option value="Finance">T√†i Ch√≠nh</option>
                        <option value="Healthcare">Y T·∫ø</option>
                        <option value="Media">Truy·ªÅn Th√¥ng</option>
                        <option value="Technology">C√¥ng Ngh·ªá</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">Thu Nh·∫≠p H√†ng Th√°ng (VND)</label>
                    <input type="number" class="form-control" name="Monthly_Income" min="0" step="1000000" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">C√¢n B·∫±ng C√¥ng Vi·ªác-Cu·ªôc S·ªëng</label>
                    <select class="form-select" name="Work_Life_Balance" required>
                        <option value="Poor">K√©m</option>
                        <option value="Fair">Trung B√¨nh</option>
                        <option value="Good">T·ªët</option>
                        <option value="Excellent">R·∫•t T·ªët</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="form-label">M·ª©c ƒê·ªô H√†i L√≤ng C√¥ng Vi·ªác</label>
                    <select class="form-select" name="Job_Satisfaction" required>
                        <option value="Low">Th·∫•p</option>
                        <option value="Medium">Trung B√¨nh</option>
                        <option value="Very High">R·∫•t Cao</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">ƒê√°nh Gi√° Hi·ªáu Su·∫•t</label>
                    <select class="form-select" name="Performance_Rating" required>
                        <option value="Low">Th·∫•p</option>
                        <option value="Below Average">D∆∞·ªõi Trung B√¨nh</option>
                        <option value="High">Cao</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">S·ªë L·∫ßn ThƒÉng Ch·ª©c</label>
                    <input type="number" class="form-control" name="Number_of_Promotions" min="0" required>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="form-label">L√†m Th√™m Gi·ªù</label>
                    <select class="form-select" name="Overtime" required>
                        <option value="No">Kh√¥ng</option>
                        <option value="Yes">C√≥</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">Kho·∫£ng C√°ch T·ª´ Nh√† (km)</label>
                    <input type="number" class="form-control" name="Distance_from_Home" min="0" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">Tr√¨nh ƒê·ªô H·ªçc V·∫•n</label>
                    <select class="form-select" name="Education_Level" required>
                        <option value="High School">THPT</option>
                        <option value="Bachelor's Degree">C·ª≠ Nh√¢n</option>
                        <option value="Master's Degree">Th·∫°c Sƒ©</option>
                        <option value="PhD">Ti·∫øn Sƒ©</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="form-label">T√¨nh Tr·∫°ng H√¥n Nh√¢n</label>
                    <select class="form-select" name="Marital_Status" required>
                        <option value="Single">ƒê·ªôc Th√¢n</option>
                        <option value="Married">ƒê√£ K·∫øt H√¥n</option>
                        <option value="Divorced">Ly H√¥n</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">S·ªë Ng∆∞·ªùi Ph·ª• Thu·ªôc</label>
                    <input type="number" class="form-control" name="Number_of_Dependents" min="0" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">C·∫•p B·∫≠c C√¥ng Vi·ªác</label>
                    <select class="form-select" name="Job_Level" required>
                        <option value="Entry">M·ªõi v√†o ngh·ªÅ</option>
                        <option value="Mid">Trung c·∫•p</option>
                        <option value="Senior">Cao c·∫•p</option>
                        <option value="Manager">Qu·∫£n l√Ω</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="form-label">Quy M√¥ C√¥ng Ty</label>
                    <select class="form-select" name="Company_Size" required>
                        <option value="Small">Nh·ªè</option>
                        <option value="Medium">Trung B√¨nh</option>
                        <option value="Large">L·ªõn</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">L√†m Vi·ªác T·ª´ Xa</label>
                    <select class="form-select" name="Remote_Work" required>
                        <option value="No">Kh√¥ng</option>
                        <option value="Yes">C√≥</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">C∆° H·ªôi L√£nh ƒê·∫°o</label>
                    <select class="form-select" name="Leadership_Opportunities" required>
                        <option value="Low">Th·∫•p</option>
                        <option value="Medium">Trung B√¨nh</option>
                        <option value="High">Cao</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="form-label">C∆° H·ªôi ƒê·ªïi M·ªõi</label>
                    <select class="form-select" name="Innovation_Opportunities" required>
                        <option value="Low">Th·∫•p</option>
                        <option value="Medium">Trung B√¨nh</option>
                        <option value="High">Cao</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">Danh Ti·∫øng C√¥ng Ty</label>
                    <select class="form-select" name="Company_Reputation" required>
                        <option value="Poor">K√©m</option>
                        <option value="Fair">Trung B√¨nh</option>
                        <option value="Good">T·ªët</option>
                        <option value="Excellent">Xu·∫•t S·∫Øc</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">Ghi Nh·∫≠n Nh√¢n Vi√™n</label>
                    <select class="form-select" name="Employee_Recognition" required>
                        <option value="Low">Th·∫•p</option>
                        <option value="Medium">Trung B√¨nh</option>
                        <option value="Very High">R·∫•t Cao</option>
                    </select>
                </div>
            </div>
            <div class="text-center">
                <button type="submit" class="btn btn-predict">D·ª± ƒêo√°n</button>
            </div>
        </form>

        <div id="results" class="prediction-result">
            <h4 class="text-center mb-4">K·∫øt Qu·∫£ D·ª± ƒêo√°n</h4>
            <div id="models-results"></div>
            
            <!-- Form ƒë√°nh gi√° tr·∫£i nghi·ªám -->
            <div id="feedback-form" class="mt-5">
                <div class="feedback-header">
                    <h5>ƒê√°nh Gi√° Tr·∫£i Nghi·ªám</h5>
                    <p class="text-muted">H√£y cho ch√∫ng t√¥i bi·∫øt tr·∫£i nghi·ªám c·ªßa b·∫°n</p>
                            </div>
                
                <form id="user-feedback-form" onsubmit="event.preventDefault(); submitFeedback();">
                    <div class="rating">
                        <!-- Rating buttons will be inserted here by JavaScript -->
                    </div>
                    
                    <div class="feedback-input">
                        <label for="feedback-text" class="form-label">N·ªôi dung ƒë√°nh gi√°:</label>
                        <textarea class="form-control" id="feedback-text" rows="4" 
                                  placeholder="H√£y chia s·∫ª √Ω ki·∫øn c·ªßa b·∫°n..." required></textarea>
                    </div>
                    
                    <div class="feedback-buttons">
                        <button type="submit" class="btn btn-primary px-4">
                            <i class="fas fa-paper-plane me-2"></i>G·ª≠i ƒê√°nh Gi√°
                        </button>
                        <a href="javascript:void(0)" onclick="viewFeedback()" class="btn btn-outline-secondary px-4 ms-2">
                            <i class="fas fa-comments me-2"></i>Xem ƒê√°nh Gi√°
                        </a>
                    </div>
                </form>
                
                <div id="success-alert" class="alert alert-success mt-3" style="display: none;"></div>
                <div id="error-alert" class="alert alert-danger mt-3" style="display: none;"></div>
            </div>
        </div>
    </div>
    
    <script>
        // Th√™m bi·∫øn cho server URL
        const SERVER_URL = 'http://localhost:8000';
        let retryCount = 0;
        const MAX_RETRIES = 3;

        // H√†m ki·ªÉm tra k·∫øt n·ªëi server v·ªõi retry
        async function checkServerConnection() {
            const statusElement = document.getElementById('server-status');
            statusElement.textContent = 'ƒêang ki·ªÉm tra k·∫øt n·ªëi...';
            statusElement.className = '';
            
            for (let i = 0; i < MAX_RETRIES; i++) {
                try {
                    console.log(`Checking server connection (attempt ${i + 1})...`);
                    console.log('Server URL:', SERVER_URL);
                    
                    const response = await fetch(`${SERVER_URL}/test`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                    });
                    
                    console.log('Server response:', response);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    console.log('Server data:', data);
                    
                    if (data.status === 'ok') {
                        statusElement.textContent = 'ƒê√£ k·∫øt n·ªëi';
                        statusElement.className = 'status-connected';
                        return true;
                    }
                } catch (error) {
                    console.error(`Connection attempt ${i + 1} failed:`, error);
                    if (i === MAX_RETRIES - 1) {
                        statusElement.textContent = 'M·∫•t k·∫øt n·ªëi';
                        statusElement.className = 'status-disconnected';
                        return false;
                    }
                    // ƒê·ª£i 1 gi√¢y tr∆∞·ªõc khi th·ª≠ l·∫°i
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            return false;
        }

        document.getElementById('prediction-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            
            // Hi·ªÉn th·ªã loading
            const submitButton = e.target.querySelector('button[type="submit"]');
            const originalText = submitButton.innerHTML;
            submitButton.innerHTML = 'ƒêang x·ª≠ l√Ω...';
            submitButton.disabled = true;
            
            // L·∫•y reference ƒë·∫øn div k·∫øt qu·∫£
            const resultsDiv = document.getElementById('models-results');
            const resultsContainer = document.getElementById('results');
            
            try {
                // Ki·ªÉm tra k·∫øt n·ªëi server tr∆∞·ªõc khi g·ª≠i d·ªØ li·ªáu
                const isServerConnected = await checkServerConnection();
                if (!isServerConnected) {
                    throw new Error('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi v√† th·ª≠ l·∫°i.');
                }

                console.log('Sending data:', data);
                const response = await fetch(`${SERVER_URL}/predict`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                console.log('Response status:', response.status);
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `L·ªói t·ª´ m√°y ch·ªß! (${response.status})`);
                }

                const result = await response.json();
                console.log('Response data:', result);
                
                if (!result || result.error) {
                    throw new Error(result?.error || 'Kh√¥ng nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu h·ª£p l·ªá t·ª´ m√°y ch·ªß');
                }

                // X√≥a n·ªôi dung c≈© v√† class show
                resultsDiv.innerHTML = '';
                resultsContainer.classList.remove('show');

                // Hi·ªÉn th·ªã k·∫øt qu·∫£ d·ª± ƒëo√°n
                if (result.prediction) {
                    console.log('Displaying prediction:', result.prediction);
                    const percentage = parseFloat(result.prediction.match(/\d+(\.\d+)?/)[0]);
                    const riskLevel = percentage >= 70 ? 'R·∫•t cao' :
                                    percentage >= 50 ? 'Cao' :
                                    percentage >= 30 ? 'Trung b√¨nh' :
                                    percentage >= 10 ? 'Th·∫•p' : 'R·∫•t th·∫•p';
                    
                    const predictionCard = document.createElement('div');
                    predictionCard.className = 'model-card';
                    predictionCard.innerHTML = `
                        <div class="alert ${percentage >= 50 ? 'alert-danger' : 'alert-success'}">
                            <h5 class="mb-3">K·∫øt qu·∫£ d·ª± ƒëo√°n</h5>
                            <p class="mb-2"><strong>T·ª∑ l·ªá ngh·ªâ vi·ªác:</strong> ${percentage}%</p>
                            <p class="mb-0"><strong>M·ª©c ƒë·ªô r·ªßi ro:</strong> ${riskLevel}</p>
                        </div>
                    `;
                    resultsDiv.appendChild(predictionCard);
                    
                    // Hi·ªÉn th·ªã container k·∫øt qu·∫£ v√† th√™m class ƒë·ªÉ k√≠ch ho·∫°t animation
                    resultsContainer.style.display = 'block';
                    // ƒê·ª£i m·ªôt ch√∫t ƒë·ªÉ DOM c·∫≠p nh·∫≠t
                    await new Promise(resolve => setTimeout(resolve, 10));
                    resultsContainer.classList.add('show');
                } else {
                    throw new Error('Kh√¥ng nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ d·ª± ƒëo√°n t·ª´ m√°y ch·ªß');
                }
            } catch (error) {
                console.error('Error details:', error);
                const errorMessage = error.message || 'Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi v√† th·ª≠ l·∫°i.';
                
                // Hi·ªÉn th·ªã l·ªói trong giao di·ªán
                resultsDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <strong>L·ªói:</strong> ${errorMessage}
                    </div>
                `;
                resultsContainer.style.display = 'block';
                // ƒê·ª£i m·ªôt ch√∫t ƒë·ªÉ DOM c·∫≠p nh·∫≠t
                await new Promise(resolve => setTimeout(resolve, 10));
                resultsContainer.classList.add('show');
            } finally {
                // Restore button state
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;
            }
        });

        // Thay ƒë·ªïi ph·∫ßn ƒë√°nh gi√°
        const ratingLabels = {
            'R·∫•t t·ªá': { text: 'R·∫•t t·ªá', icon: 'üòû' },
            'T·ªá': { text: 'T·ªá', icon: 'üòï' },
            'B√¨nh th∆∞·ªùng': { text: 'B√¨nh th∆∞·ªùng', icon: 'üòê' },
            'T·ªët': { text: 'T·ªët', icon: 'üòä' },
            'R·∫•t t·ªët': { text: 'R·∫•t t·ªët', icon: 'üòÉ' }
        };

        function createRatingSystem() {
            const ratingContainer = document.querySelector('.rating');
            ratingContainer.innerHTML = '';
            
            const ratings = ['R·∫•t t·ªët', 'T·ªët', 'B√¨nh th∆∞·ªùng', 'T·ªá', 'R·∫•t t·ªá'];
            for (const rating of ratings) {
                const label = document.createElement('label');
                label.className = 'btn btn-outline-primary mx-1';
                label.innerHTML = `
                    <input type="radio" name="rating" value="${rating}" class="btn-check">
                    <div>
                        <div style="font-size: 24px;">${ratingLabels[rating].icon}</div>
                        <div>${ratingLabels[rating].text}</div>
                    </div>
                `;
                ratingContainer.appendChild(label);
            }
        }

        async function submitFeedback() {
            const rating = document.querySelector('input[name="rating"]:checked');
            const feedbackText = document.getElementById('feedback-text').value;
            const successAlert = document.getElementById('success-alert');
            const errorAlert = document.getElementById('error-alert');

            // ·∫®n c√°c alert c≈©
            successAlert.style.display = 'none';
            errorAlert.style.display = 'none';

            if (!rating) {
                showError('Vui l√≤ng ch·ªçn m·ª©c ƒë·ªô ƒë√°nh gi√°');
                return;
            }

            if (!feedbackText.trim()) {
                showError('Vui l√≤ng nh·∫≠p n·ªôi dung ƒë√°nh gi√°');
                return;
            }

            try {
                const submitButton = document.querySelector('#user-feedback-form button[type="submit"]');
            const originalText = submitButton.innerHTML;
                submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ƒêang g·ª≠i...';
            submitButton.disabled = true;
            
                const response = await fetch(`${SERVER_URL}/submit-feedback`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        rating: rating.value,
                        feedback: feedbackText.trim()
                    })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'C√≥ l·ªói x·∫£y ra khi g·ª≠i ƒë√°nh gi√°');
                }

                // Reset form
                    document.getElementById('user-feedback-form').reset();
                showSuccess(data.message || 'C·∫£m ∆°n b·∫°n ƒë√£ g·ª≠i ƒë√°nh gi√°!');
                
                // T·ª± ƒë·ªông chuy·ªÉn ƒë·∫øn trang xem ƒë√°nh gi√° sau 2 gi√¢y
                setTimeout(() => {
                    window.location.href = `${SERVER_URL}/view-feedback`;
                }, 2000);

            } catch (error) {
                console.error('Error submitting feedback:', error);
                showError(error.message || 'C√≥ l·ªói x·∫£y ra khi g·ª≠i ƒë√°nh gi√°. Vui l√≤ng th·ª≠ l·∫°i sau.');
            } finally {
                const submitButton = document.querySelector('#user-feedback-form button[type="submit"]');
                submitButton.innerHTML = '<i class="fas fa-paper-plane me-2"></i>G·ª≠i ƒê√°nh gi√°';
                submitButton.disabled = false;
            }
        }

        function showSuccess(message) {
            const alert = document.getElementById('success-alert');
            alert.textContent = message;
            alert.style.display = 'block';
            alert.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function showError(message) {
            const alert = document.getElementById('error-alert');
            alert.textContent = message;
            alert.style.display = 'block';
            alert.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Th√™m h√†m m·ªõi ƒë·ªÉ xem ƒë√°nh gi√°
        async function viewFeedback() {
            try {
                // Ki·ªÉm tra k·∫øt n·ªëi server
                const isServerConnected = await checkServerConnection();
                if (!isServerConnected) {
                    showError('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi v√† th·ª≠ l·∫°i.');
                    return;
                }

                // Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang xem ƒë√°nh gi√° tr√™n server
                window.location.href = `${SERVER_URL}/view-feedback`;
            } catch (error) {
                console.error('Error accessing feedback page:', error);
                showError('C√≥ l·ªói x·∫£y ra khi truy c·∫≠p trang ƒë√°nh gi√°. Vui l√≤ng th·ª≠ l·∫°i sau.');
            }
        }

        // Kh·ªüi t·∫°o h·ªá th·ªëng ƒë√°nh gi√° khi trang ƒë∆∞·ª£c t·∫£i
        document.addEventListener('DOMContentLoaded', () => {
            createRatingSystem();
            console.log('Initializing connection check...');
            checkServerConnection();
            // Ki·ªÉm tra l·∫°i k·∫øt n·ªëi m·ªói 30 gi√¢y
            setInterval(checkServerConnection, 30000);
        });
    </script>
</body>
</html> 